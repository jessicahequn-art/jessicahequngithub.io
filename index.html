<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿é™©éœ€æ±‚è®¡ç®—å™¨ - Invar&lt;Calc Pro&gt;</title>
    <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .app-header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 3rem 2rem;
            text-align: center;
        }

        .app-header h1 {
            font-size: 2.8rem;
            margin-bottom: 1rem;
            font-weight: 300;
        }

        .app-header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 2rem;
        }

        /* è¡¨å•æ ·å¼ */
        .client-form {
            display: grid;
            gap: 2rem;
        }

        .form-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 2rem;
            border-left: 5px solid #667eea;
        }

        .form-section h2 {
            color: #2c3e50;
            margin-bottom: 1.5rem;
            font-size: 1.4rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: #2c3e50;
            font-size: 0.95rem;
        }

        .form-group input {
            padding: 1rem;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
            transform: translateY(-2px);
        }

        .total-display {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
            font-size: 1.2rem;
            border: 2px solid #e1e8ed;
            margin-top: 1rem;
            font-weight: 700;
            color: #2c3e50;
        }

        .checkbox-group {
            display: flex;
            gap: 2rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            font-weight: 500;
            color: #2c3e50;
            padding: 0.5rem 1rem;
            background: white;
            border-radius: 6px;
            border: 1px solid #e1e8ed;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: #667eea;
        }

        .form-actions {
            text-align: center;
            margin-top: 2rem;
            padding: 2rem;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .calculate-btn {
            padding: 1.2rem 3rem;
            font-size: 1.3rem;
            min-width: 320px;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.4);
        }

        .calculate-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.75rem;
            min-width: 160px;
            justify-content: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-1px);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .app-header h1 {
                font-size: 2.2rem;
            }

            .app-header {
                padding: 2rem 1rem;
            }

            .main-content {
                padding: 1rem;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .app-header h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div id="root"></div>
    </div>

    <script type="text/babel">
        const { useState } = React;

        const formatCurrency = (value) => {
            return new Intl.NumberFormat('en-CA', {
                style: 'currency',
                currency: 'CAD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(value);
        };

        const calculateInsuranceNeed = (clientData) => {
            const totalIncome = (clientData.income.employment || 0) + (clientData.income.rental || 0) +
                               (clientData.income.investment || 0) + (clientData.income.other || 0);

            const totalLiabilities = (clientData.liabilities.mortgage1 || 0) +
                                      (clientData.liabilities.mortgage2 || 0) +
                                      (clientData.liabilities.otherLoans || 0);

            const totalAssets = (clientData.assets.cash || 0) + (clientData.assets.canadianInvestments || 0) +
                               (clientData.assets.canadianProperties || 0) + (clientData.assets.overseasFinancial || 0) +
                               (clientData.assets.overseasProperties || 0) + (clientData.assets.otherAssets || 0);

            const futureValue = totalAssets * Math.pow(1 + (clientData.taxInfo.growthRate || 0), clientData.taxInfo.calculationYears || 0);
            const capitalGain = futureValue - (clientData.taxInfo.assetsACB || 0);
            const taxableGain = capitalGain * (clientData.taxInfo.inclusionRate || 0);
            const futureTax = taxableGain * (clientData.taxInfo.marginalTaxRate || 0);

            const incomeReplacement = totalIncome * 20;
            const debtCoverage = totalLiabilities;

            let overseasContribution = 0;
            if (clientData.settings.includeOverseasAssets) {
                const overseasTotal = (clientData.assets.overseasFinancial || 0) + (clientData.assets.overseasProperties || 0);
                if (clientData.settings.overseasVerifiable) {
                    overseasContribution = overseasTotal * 0.5;
                } else {
                    overseasContribution = overseasTotal * 0.25;
                }
                overseasContribution = Math.min(overseasContribution, 10000000);
            }

            const totalInsuranceNeed = incomeReplacement + debtCoverage + futureTax + overseasContribution;

            return {
                totalInsuranceNeed,
                breakdown: {
                    incomeReplacement,
                    debtCoverage,
                    futureTax,
                    overseasContribution
                },
                assumptions: {
                    totalIncome,
                    totalAssets,
                    totalLiabilities,
                    futureValue,
                    capitalGain,
                    taxableGain
                }
            };
        };

        const InsuranceCalculator = () => {
            const [clientData, setClientData] = useState({
                personalInfo: {
                    name: '',
                    age: 52,
                    occupation: 'æˆ¿åœ°äº§',
                    lifeExpectancy: 90
                },
                income: {
                    employment: 0,
                    rental: 50000,
                    investment: 1200000,
                    other: 0
                },
                assets: {
                    cash: 0,
                    canadianInvestments: 20000000,
                    canadianProperties: 5500000,
                    overseasFinancial: 2000000,
                    overseasProperties: 5000000,
                    otherAssets: 0
                },
                liabilities: {
                    mortgage1: 300000,
                    mortgage2: 600000,
                    otherLoans: 0
                },
                taxInfo: {
                    assetsACB: 22000000,
                    inclusionRate: 0.5,
                    marginalTaxRate: 0.535,
                    growthRate: 0.06,
                    calculationYears: 20
                },
                settings: {
                    includeOverseasAssets: true,
                    overseasVerifiable: false
                }
            });

            const [calculationResult, setCalculationResult] = useState(null);
            const [isCalculating, setIsCalculating] = useState(false);

            const handleInputChange = (section, field, value) => {
                setClientData(prev => ({
                    ...prev,
                    [section]: {
                        ...prev[section],
                        [field]: value
                    }
                }));
            };

            const handleCalculate = (e) => {
                e.preventDefault();
                setIsCalculating(true);

                setTimeout(() => {
                    const result = calculateInsuranceNeed(clientData);
                    setCalculationResult(result);
                    setIsCalculating(false);
                }, 800);
            };

            const handleReset = () => {
                setCalculationResult(null);
            };

            const totalIncome = Object.values(clientData.income).reduce((sum, val) => sum + (Number(val) || 0), 0);
            const totalAssets = Object.values(clientData.assets).reduce((sum, val) => sum + (Number(val) || 0), 0);
            const totalLiabilities = Object.values(clientData.liabilities).reduce((sum, val) => sum + (Number(val) || 0), 0);

            if (calculationResult) {
                return (
                    <div>
                        <header className="app-header">
                            <h1>InsureCalc Pro</h1>
                            <p>ä¸“ä¸šä¿é™©éœ€æ±‚åˆ†æå·¥å…·</p>
                        </header>
                        <main className="main-content">
                            <div className="results-display">
                                <div className="results-header">
                                    <h2>ğŸ¯ ä¿é™©éœ€æ±‚åˆ†æç»“æœ</h2>
                                    <p className="client-name">å®¢æˆ·: {clientData.personalInfo.name || 'æœªå‘½åå®¢æˆ·'}</p>
                                </div>
                                <div className="total-amount">
                                    <div className="amount-figure">{formatCurrency(calculationResult.totalInsuranceNeed)}</div>
                                    <div className="amount-label">æ¨èæ€»ä¿é¢</div>
                                </div>
                            </div>
                        </main>
                    </div>
                );
            }

            return (
                <div>
                    <header className="app-header">
                        <h1>InsureCalc Pro</h1>
                        <p>ä¸“ä¸šä¿é™©éœ€æ±‚åˆ†æå·¥å…·</p>
                    </header>
                    <main className="main-content">
                        <form onSubmit={handleCalculate} className="client-form">
                            <div className="form-section">
                                <h2>ğŸ‘¤ å®¢æˆ·åŸºæœ¬ä¿¡æ¯</h2>
                                <div className="form-grid">
                                    <div className="form-group">
                                        <label>å§“å</label>
                                        <input
                                            type="text"
                                            value={clientData.personalInfo.name}
                                            onChange={(e) => handleInputChange('personalInfo', 'name', e.target.value)}
                                            placeholder="è¯·è¾“å…¥å®¢æˆ·å§“å"
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>å¹´é¾„</label>
                                        <input
                                            type="number"
                                            value={clientData.personalInfo.age}
                                            onChange={(e) => handleInputChange('personalInfo', 'age', parseInt(e.target.value) || 0)}
                                        />
                                    </div>
                                </div>
                            </div>
                            <div className="form-actions">
                                <button type="submit" className="calculate-btn" disabled={isCalculating}>
                                    {isCalculating ? 'ğŸ”„ è®¡ç®—ä¸­...' : 'ğŸ¯ ç«‹å³è®¡ç®—ä¿é™©éœ€æ±‚'}
                                </button>
                            </div>
                        </form>
                    </main>
                </div>
            );
        };

        ReactDOM.render(<InsuranceCalculator />, document.getElementById('root'));
    </script>
</body>
</html>